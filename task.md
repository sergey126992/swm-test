# Тестовое задание на вакансию PHP разработчика
 
## Технологии
PHP (Laravel) + PostgreSQL

## Основная информация
Дано: список пользователей следующего вида (пример представлен в формате `JSON`):

```
[
  {
    "id": 1,
    "name": "Ivan Ivanov",
    "data": {
      "date_of_birth": "1990-08-03",
      "gender": "male"
    },
    "created_at": "2018-01-06T08:16:13.992Z",
    "updated_at": "2018-01-06T08:16:13.992Z"
  },
  {
    "id": 2,
    "name": "Petr Petrov",
    "data": {
      "hobby": ["football", "fishing"],
      "gender": "male"
    },
    "created_at": "2018-03-15T15:22:00.992Z",
    "updated_at": "2018-05-10T12:02:42.992Z"
  },
  {
    "id": 3,
    "name": "Unknown user",
    "data": {
      "hobby": ["snowboarding", "cycling"],
    },
    "created_at": "2018-06-03T17:22:11.992Z",
    "updated_at": "2019-02-06T22:31:50.992Z"
  },
  {
    "id": 4,
    "name": "Dasha",
    "data": {
      "gender": "female",
    },
    "created_at": "2018-08-01T11:21:15.992Z",
    "updated_at": "2018-08-02T12:16:40.992Z"
  },
]
```

Параметр `data` в данных каждого пользователя является объектом с заранее определенным количеством возможных ключей и типов значений. Для простоты представим что таких параметров у нас 3 (но нужно иметь ввиду, что предложенное решение не должно быть завязано на это ограничение, параметры могут добавляться с течением времени, и это не должно влиять на работу программы, способ хранения данных и т.п.):

* `date_of_birth` – дата рождения (дата)
*  `gender` – пол (строка, имеет одно из двух значений `"male"` / `"female"`)
* `hobby` – увлечения (массив строковых значений из определенного списка, который представлен ниже)

Параметры в поле `data` могут быть заполнены, а могут отсутствовать (пользователь имеет право заполнить только ту информацию, которую хочет, обязательных параметров нет).


Список доступных увлечений (в формате `JSON`):

```
[
  "football",
  "hockey",
  "curling",
  "snowboarding",
  "skiing",
  "fishing",
  "cycling",
  "baseball",
  "basketball"
]
```

## Задача 1.
Создать необходимые модели сущностей на базе [ORM Eloquent](https://laravel.com/docs/5.7/eloquent)

## Задача 2.
Создать необходимые [миграции для базы данных](https://laravel.com/docs/5.7/migrations), чтобы были созданы нужные таблицы, поля имели нужные типы и были проставлены необходимые индексы

## Задача 3. 
Написать [сидеры данных](https://laravel.com/docs/5.7/seeding), чтобы наполнить таблицы тестовыми записями (количество записей: от 100 до 500, значения – фейковые, но должны отражать суть, например желательно чтобы имена были реальные, даты в в адекватных рамках и т.п.)

## Задача 4.
Реализовать API для выдачи списка моделей из базы данных, которые подходят под переданный набор фильтров. 

Фильтры передаются GET параметром и имеют следующий формат:

* `age` –  объект с двумя возможными ключами: `from` и `to`, значения для которых – `integer`
* `gender` – строка (`male` / `female`)
* `hobby` – массив строк, значения из списка доступных хобби (см. выше)

Пример GET запроса c фильтрами:
```
http://127.0.0.1:8080/users?age[from]=18&age[to]=24&gender=male&hobby[]=football&hobby[]=snowboarding
```

В приведённом выше примере мы должны выбрать всех мужчин в возрасте от 18 до 24 лет, у которых в качестве хобби указан футбол или сноубординг или оба значения

Должна быть предусмотрена возможность поиска по всем параметрам сразу или только по одному (например по возрасту можно делать поиск как по открытому промежутку: "только от N лет" или "только до N лет", так и по закрытому "от N до M лет")

### Что должно получиться в итоге:
API с одним единственным методом для получения списка пользователей  `GET /users`. Фильтры передаются GET- параметрами как в примере выше. В ответ сервер должен выдать список пользователей, найденных по указанным фильтрам в формате `JSON`. Пагинация на ваше усмотрение.

## Задача 5 

*Эта задача не обязательна к выполнению. Можно присылать выполненную работу без решения этой задачи. Но выполнение этой задачи повысит ваши шансы на получение работы*

У каждого пользователя помимо перечисленных выше параметров появляется новый параметр `geo_location` – географические координаты (широта и долгота):

```
{
  "id": 1,
  "name": "Ivan Ivanov",
  "data": {
    "date_of_birth": "1990-08-03",
    "gender": "male"
  },
  "geo_location": {
    "lat": 55.7558,
    "lng": 37.6173
  },
  "created_at": "2018-01-06T08:16:13.992Z",
  "updated_at": "2018-01-06T08:16:13.992Z"
}
```

Необходимо реализовать дополнительный фильтр по координатам в пределах заданного участка. Участок определяется двумя координатами: левый верхний и правый нижний угол прямоугольной области в пределах которой нужно искать. 

* `geo_location` – объект с двумя ключами `nw` (north-west) и `se` (south-east). Значение каждого из ключей – объект с двумя ключами `lat` (latitude) и `lng`(longitude). 

Поиск должен производиться всегда в пределах закрытой прямоугольной области. Если какой-то из необходимых параметров объекта `geo_location` не задан или передан неверно, то фильтрацию по координатам можно не производить (просто проигнорировать данный фильтр)

Пример GET запроса для поиска по координатам:

```
geo_location[nw][lat]=52.57&geo_location[nw][lng]=3.76&geo_location[se][lat]=52.13&geo_location[se][lng]=6.06
```

Разрешается использовать расширение [PostGIS](https://postgis.net/) для базы данных PostgeSQL при выполнении данного задания. 

Так же вполне подойдет описание необходимой структуры базы данных и SQL запроса для выполнения требуемого поиска без необходимости реализовывать это.

## Результат тестового задания
Мы ожидаем в качестве результата вашей работы получить доступ к git-репозиторию (gitlab / github) с кодом вашей работы. Обязательно прикладывайте описание подготовительных шагов, необходимых для запуска вашего приложения (например в файле `README.md`).

Выполненные задания и вопросы можно присылать на alexfitiskin@gmail.com
